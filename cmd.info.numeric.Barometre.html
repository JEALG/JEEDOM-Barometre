<div style="min-width:80px; mini-height:90px;" class="cmd tooltips cmd-widget cursor container-fluid" data-type="info" data-subtype="numeric" data-cmd_id="#id#" data-cmd_uid="#uid#">
 	<!-- Info Widget
		Basé sur les widget de 	: jpoilux
		Mise à jour 			: JAG 20190310 11:50
	-->
	<center>
      <span class='cmdName' style="font-weight: bold;font-size : 0.8em;width: 65px;height: 17px;overflow: hidden;position: relative;#hideCmdName#;" title="#name#">#name_display#</span>
  	</center>
  
  <center>
    	<div style="text-align:center;">
          <div id="barometreDivIMG#id#" class="barometre_div_img">
              <span id="barometreIMG#id#" class="iconCmd barometre_img"></span>
          </div>
          <div style="display:inline-block;">
            <span class="barometre_state"id="barometreState#id#">#state#</span>	
            <span class="barometre_unite"id="barometreUnite#id#">#unite#</span>
              <div> <!-- légende -->
                  <span style="margin-top : 10px;line-height:10px;font-size: 0.7em;font-weight: bold;display: inline-block;text-align: justify;#displayHistory#">
                      <span title='Min' class='tooltips left'>Min : </span><span style="float:right;">#minHistoryValue# #unite#</span><br/>
                      <span title='Moyenne' class='tooltips'>Moy : </span><span style="float:right;">#averageHistoryValue# #unite#</span><br/>
                      <span title='Max' class='tooltips'>Max : </span><span style="float:right;">#maxHistoryValue# #unite#</span><br/>
                      <i class="#tendance#"></i>
                  </span>
              </div>
          </div>
        </div>
          
	</center>
	<script>
      	// Options de personnalisation avec valeur par defaut 
        	// Paramètrage du logo
				var srcImglogo		= ('#logo#'!='#'+'logo#') ? "#logo#" : "Baro";
        	// Paramètrage de la position de la légende
				var srcImgleg_pos	= ('#leg_pos#'!='#'+'leg_pos#') ? "#leg_pos#" : "right";
        // Paramètre "sizehw" : à déclarer en pixels - 92 maxi
      			var srcImgHeight	= (is_numeric('#sizeh#')) ? parseFloat('#sizeh#') : 80;
      			var srcImgWidth 	= (is_numeric('#sizew#')) ? parseFloat('#sizew#') : 83;
        // Paramétrage des images
        		var srcImgURL 		= 'plugins/widget/core/template/dashboard/cmd.info.numeric.Barometre/'; 
      
      
		// Choix IMG
			var iconUpdate = function (state){
                $('.cmd[data-cmd_uid=#uid#] .iconCmd').empty();
                if (state <= 945 ) {
                    level 		= 940;
                } else if (state > 945  && state <= 955 ) {
                    level 		= 950;
                } else if (state > 955 && state <= 965) {
                    level 		= 960;
                } else if (state > 965 && state <= 975) {
                  	level 		= 970;
                } else if (state > 975 && state <= 985 ) {
                  	level 		= 980;
                } else if (state > 985 && state <= 995) {
                  	level 		= 990;
                } else if (state > 985 && state <= 1005) {
                  	level 		= 1000;
                } else if (state > 985 && state <= 1005) {
                  	level 		= 1005;
                } else if (state > 1005 && state <= 1015) {
                  	level 		= 1010;
                } else if (state > 1015 && state <= 1025) {
                  	level 		= 1020;
                } else if (state > 1025 && state <= 1035) {
                  	level 		= 1030;                  
                } else if (state > 1035 && state <= 1045) {
                  	level 		= 1040;
                } else if (state > 1045 && state <= 1055) {
                  	level 		= 1050; 
                 } else if (state > 1055) {
                  	level 		= 1060;  
                } else {
                  	level 		= "error";
                }
              	// Update Value or img
              		$('.cmd[data-cmd_uid=#uid#] .iconCmd').html('<img src="'+srcImgURL +srcImglogo +level+ '.png" style="height:' + srcImgHeight +'px;width:' + srcImgWidth +'px;">'); 
			$('.cmd[data-cmd_uid=#uid#] .state').text(state);
			};      
				// Paramétrage des affichage
					// Position image
						if (srcImgleg_pos == "right"){
                          $("#barometreDivIMG#id#.barometre_div_img").css("float","left");
                          $("#barometreIMG#id#.barometre_img").css("margin-right","15px"); 
                      	} else if (srcImgleg_pos == "left"){
                          $("#barometreDivIMG#id#.barometre_div_img").css("float","right");
                          $("#barometreIMG#id#.barometre_img").css("margin-left","15px");
                      	} else { 
                          //aucune modification nécessaire
                      	}
					// Position Texte 
      						$("#barometreUnite#id#.barometre_unite").css("margin-top","-30px");
                        if (srcImgleg_pos == "right") {
                            $("#barometreState#id#.barometre_state").css("margin-left","-30px"); 
                            $("#barometreUnite#id#.barometre_unite").css("display","block");
                            $("#barometreUnite#id#.barometre_unite").css("margin-left","60px");
                        } else if (srcImgleg_pos == "left"){
                            $("#barometreState#id#.barometre_state").css("margin-right","18px"); 
                            $("#barometreUnite#id#.barometre_unite").css("display","block");
                            $("#barometreUnite#id#.barometre_unite").css("margin-left","70px");
                        } else if (srcImgleg_pos == "low"){ 
                            $("#barometreUnite#id#.barometre_unite").css("display","block");
                            
                            $("#barometreUnite#id#.barometre_unite").css("margin-left","90px");
                        }
      
	jeedom.cmd.update['#id#'] = function(_options){
		$('.cmd[data-cmd_uid=#uid#]').attr('title','Valeur du '+_options.valueDate+', collectée le '+_options.collectDate)
		iconUpdate(_options.display_value);
	}
	jeedom.cmd.update['#id#']({display_value:'#state#',valueDate:'#valueDate#',collectDate:'#collectDate#',alertLevel:'#alertLevel#'});
	</script>
</div>
<style> 
span.barometre_img {
  	height: 80px;
  }
span.barometre_div_img {
    margin-left: 5px;
	position:relative;
  	height: 64px;
  	width: 62px;
	float:left;
  }  
span.barometre_state {
  	font-weight: bold;
  	font-size: 1.5em;
  	margin-top: 5px;
  	display: block;
  }
span.barometre_unite {
  	font-size: 0.7em;
  	margin-top: 5px;
  	top: 22px;
  }

</style>